# Обзор

Когда вы инициализируете проект, вы создаете серверную среду Amplify. Каждая серверная среда Amplify - это контейнер для категорий, добавленных в ваш проект. Чтобы развернуть обновления в среде, запустите `ampify push`. В командах, где несколько участников работают над одним и тем же серверным модулем, рекомендуется запускать `ampify pull` для получения изменений из восходящего потока перед началом работы над новыми функциями внутреннего интерфейса. Просмотрите список серверных сред в вашем облачном проекте, посетив [Amplify Console](https://console.aws.amazon.com/amplify).

Для нескольких сред Amplify соответствует стандартному рабочему процессу Git, в котором вы переключаетесь между разными ветвями с помощью команды `env checkout` - аналогично запуску `git checkout BRANCHNAME`, запускайте `ampify env checkout ENVIRONMENT_NAME` для переключения между средами. На схеме ниже показан рабочий процесс инициализации новых сред при создании новых веток git.

![Image](https://docs.amplify.aws/images/AmplifyEnvSwitching.jpg)

Вы можете независимо добавлять функции в каждую среду, что позволяет вам разрабатывать и тестировать, прежде чем переносить их на разные этапы. Используя тот же пример, приведенный выше, где **Dev** является базой, на которой были созданы **Test** и **Prod**, вы можете добавлять (или удалять) функции, а также объединять и развертывать соответственно, как только вы будете довольны своей настройкой.

![Image](https://docs.amplify.aws/images/AmplifyEnvAddDeploy.jpg)

Это можно делать итеративно по мере проработки:


![Image](https://docs.amplify.aws/images/AmplifyEnvAddDeploySwitching.jpg)

Несколько разработчиков в команде также могут совместно использовать среду и управлять ею, используя учетные данные в учетной записи. Например, предположим, что они хотят протестировать изменение API, не влияя на развертывания **Test** или **Prod**. Это позволит им тестировать настроенные ресурсы и, если им были предоставлены соответствующие разрешения CloudFormation, они также могут отправлять ресурсы на серверную часть с помощью `ampify push`.

![Image](https://docs.amplify.aws/images/AmplifyEnvMultDevelopers.jpg)

В качестве альтернативы вы можете попросить разработчиков настроить свою собственную изолированную реплику этих сред в другой учетной записи AWS. Для этого просто:
1. Клонируйте существующий проект.
2. Запустите `ampify env add` и настройте новую среду (например, mydev) с учетной записью разработчика и профилем AWS.
3. Разверните с помощью `ampify push`


Этот рабочий процесс можно использовать для совместного использования полных проектов Amplify с людьми за пределами вашей организации, а также путем фиксации проекта в репозитории Git. Если вы делаете это, удалите (или добавьте в .gitignore) **team-provider-info.json**, который находится в каталоге `ampify`. Вы можете узнать больше об этом файле [здесь](~/cli/teams/shared.md#sharing-projects-outside-the-team).

### Непрерывное развертывание и хостинг

Amplify CLI поддерживает базовый хостинг веб-приложений с помощью Amazon S3 и CloudFront. Вы можете использовать функцию нескольких сред с консолью Amplify для полностью управляемого хостинга веб-приложений и решения для развертывания. Дополнительные сведения см. в [официальной документации](https://docs.aws.amazon.com/amplify/latest/userguide/multi-environments.html).

### Настройка среды prod и dev

Создайте репозиторий Git для своего проекта, если вы еще этого не сделали. Рекомендуется управлять отдельными ветвями Git для разных сред (старайтесь иметь то же имя ветки, что и имя вашей среды, чтобы избежать путаницы).
Из корня вашего проекта выполните следующие команды:

```
$ amplify init
? Enter a name for the environment: prod
// Provide AWS Profile info
// Add amplify categories using `amplify add <category>`
$ git init
$ git add <all project related files>
$ git commit -m "Creation of a prod amplify environment"
$ git remote add origin git@github.com:<repo-name>
$ git push -u origin prod
```

**Примечание**: когда вы инициализируете проект с помощью интерфейса командной строки Amplify, он добавляется (если файл gitignore существует в корне проекта) или создает его для вас (если файл gitignore не существует в корне вашего project) со списком рекомендуемых файлов для возврата из списка файлов, созданного Amplify CLI, в репозиторий Git.

После настройки ветки prod в Git настройте среду dev в своем проекте Amplify (которая будет основана на среде prod), а затем выполните следующие шаги, чтобы создать соответствующую ветку git.

```
$ amplify env add
? Do you want to use an existing environment? No
? Enter a name for the environment dev
// Provide AWS Profile info
```

Это создаст другую среду для проекта в облаке. Бэкэнд-конфигурации и ресурсы теперь клонированы из среды prod. Запустите `ampify push`, чтобы выделить все ресурсы AWS для вашей новой среды (dev).

Теперь внесите изменения в ветку 'prod' (вы просто увидите изменения в файле team-provider-info.json - при запуске команды `git status`, которая содержит информацию кумулятивного стека для всех сред проекта, которые полезны, когда вы хотите использовать одну и ту же серверную часть в команде). После этого давайте создадим новую ветку git - «dev», соответствующую новой среде, которую мы только что создали.

```
$ git add .
$ git commit -m "Creation of a dev amplify environment"
$ git push -u origin prod
$ git checkout -b dev
$ git push -u origin dev
```
